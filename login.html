<!DOCTYPE html>
<html lang="en">
    <head>
        <script async src="https://www.googletagmanager.com/gtag/js?id=GTM-NX2QKP76"></script>
        <script>
          window.dataLayer = window.dataLayer || [];
          function gtag(){dataLayer.push(arguments);}
          gtag('js', new Date());

          gtag('config', 'G-7FN7LEVWXD');
        </script>

        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="shortcut icon" href="/images/ico.ico" type="image/x-icon">
        <link rel="stylesheet" href="/storage/css/index.css">
        <title>Login | Vexplay</title>

        <meta name="description" content="Login to Vexplay - an open source games site hosting 500+ games, useful utilities, powerful settings + a clean user interface">
        <meta property="og:site_name" content="Vexplay">
        <meta property="og:title" content="Vexplay Login">
        <meta property="og:type" content="website">
        <meta property="og:description" content="Login to Vexplay - an open source games site hosting 500+ games, useful utilities, powerful settings + a clean user interface">
        
        <style>
            .content-side {
                min-height: 100vh;
                justify-content: flex-start;
                padding-top: 40px;
                padding-bottom: 60px;
                box-sizing: border-box;
                position: relative;
            }

            .auth-container {
                max-width: 400px;
                margin: 0 auto;
                padding: 20px;
                border: 3px solid var(--border-color2);
                border-radius: 16px;
                background-color: var(--background-color);
            }
            
            .form-group {
                margin-bottom: 15px;
            }
            
            .form-group label {
                display: block;
                margin-bottom: 5px;
                font-size: 16px;
            }
            
            .form-group input {
                width: 100%;
                padding: 12px;
                font-size: 16px;
                border: 2px solid var(--border-color2);
                border-radius: 8px;
                background-color: rgba(0, 0, 0, 0.2); /* Darker background for input */
                color: var(--text-color);
                font-family: var(--font-family);
                box-sizing: border-box; /* Make sure padding doesn't affect width */
                transition: border-color 0.2s, background-color 0.2s;
            }
            
            .form-group input:focus {
                outline: none;
                border-color: var(--hover-color);
                background-color: rgba(0, 0, 0, 0.3); /* Even darker on focus */
            }
            
            .auth-button {
                width: 100%;
                padding: 12px;
                background-color: var(--background-color);
                color: var(--text-color);
                border: 3px solid var(--border-color2);
                border-radius: 8px;
                font-size: 16px;
                cursor: pointer;
                font-family: var(--font-family);
                margin-top: 10px;
                transition: background-color 0.15s ease-in-out;
            }
            
            .auth-button:hover {
                background-color: var(--hover-color);
            }
            
            .auth-divider {
                text-align: center;
                margin: 20px 0;
                position: relative;
            }
            
            .auth-divider::before {
                content: "";
                position: absolute;
                top: 50%;
                left: 0;
                right: 0;
                height: 1px;
                background-color: var(--border-color2);
            }
            
            .auth-divider span {
                position: relative;
                background-color: var(--background-color);
                padding: 0 10px;
                color: var(--text-color);
            }
            
            .google-button {
                display: flex;
                align-items: center;
                justify-content: center;
                gap: 10px;
            }
            
            .google-button img {
                width: 20px;
                height: 20px;
            }
            
            .auth-footer {
                text-align: center;
                margin-top: 20px;
            }
            
            .auth-footer a {
                color: var(--text-color);
                text-decoration: underline;
                transition: color 0.15s;
            }
            
            .auth-footer a:hover {
                color: var(--hover-color);
            }
            
            .auth-error {
                color: #ff6b6b;
                margin-top: 10px;
                margin-bottom: 15px;
                text-align: center;
                padding: 8px;
                border-radius: 8px;
                background-color: rgba(255, 107, 107, 0.1);
                display: none;
            }

            .footer-links {
                position: absolute;
                bottom: 20px;
                width: 100%;
                text-align: center;
            }
        </style>
  </head>
  <body>
      <div class="content-side">
          <h1 class="typewriter">Vexplay</h1>
          <h2>login to your account</h2>

          <div class="auth-container">
              <div id="loginError" class="auth-error"></div>
              
              <div class="form-group">
                  <label for="email">Email</label>
                  <input type="email" id="email" placeholder="Enter your email">
              </div>
              
              <div class="form-group">
                  <label for="password">Password</label>
                  <input type="password" id="password" placeholder="Enter your password">
              </div>
              
              <button class="auth-button" id="loginButton">Login</button>
              
              <div class="auth-divider">
                  <span>or</span>
              </div>
              
              <button class="auth-button google-button" id="googleLoginButton">
                  <img src="https://upload.wikimedia.org/wikipedia/commons/5/53/Google_%22G%22_Logo.svg" alt="Google logo">
                  Continue with Google
              </button>
              
              <div class="auth-footer">
                  <p>Don't have an account? <a href="signup.html">Sign up</a></p>
                  <p>Continue as <a href="#" id="guestLoginButton">Guest</a></p>
              </div>
          </div>

          <div class="footer-links">
              <p class="linkp"><a href="index.html">back to homepage</a> â€¢ <a href="https://discord.gg/k9MH6Y875s" target="_blank">discord</a></p>
          </div>
      </div>

      <!-- Firebase SDK -->
      <script type="module">
        // Import the functions you need from the SDKs you need
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getAnalytics } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-analytics.js";
        import { getAuth, signInWithEmailAndPassword, GoogleAuthProvider, signInWithPopup } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
        
        // Your web app's Firebase configuration
        const firebaseConfig = {
          apiKey: "AIzaSyBrD_IAs4WIf4ikI-9jdwgH65gXErj8Dv8",
          authDomain: "vexplay-33e9f.firebaseapp.com",
          projectId: "vexplay-33e9f",
          storageBucket: "vexplay-33e9f.firebaseStorage.app",
          messagingSenderId: "797854431681",
          appId: "1:797854431681:web:b09b88437937b9fc551740",
          measurementId: "G-KRWYW4Z4Y3"
        };

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const analytics = getAnalytics(app);
        const auth = getAuth(app);
        const provider = new GoogleAuthProvider();

        // Email and password login
        document.getElementById('loginButton').addEventListener('click', () => {
            const email = document.getElementById('email').value;
            const password = document.getElementById('password').value;
            const errorElement = document.getElementById('loginError');
            
            if (!email || !password) {
                errorElement.textContent = "Please enter both email and password";
                errorElement.style.display = "block";
                return;
            }
            
            signInWithEmailAndPassword(auth, email, password)
                .then((userCredential) => {
                    // Login successful
                    const user = userCredential.user;
                    localStorage.setItem('userLoggedIn', 'true');
                    localStorage.setItem('userEmail', user.email);
                    localStorage.setItem('userId', user.uid);
                    localStorage.setItem('isGuest', 'false');
                    window.location.href = 'index.html';
                })
                .catch((error) => {
                    // Handle errors
                    const errorCode = error.code;
                    const errorMessage = error.message;
                    console.error(errorCode, errorMessage);
                    
                    if (errorCode === 'auth/invalid-credential') {
                        errorElement.textContent = "Invalid email or password";
                    } else if (errorCode === 'auth/user-not-found') {
                        errorElement.textContent = "No account found with this email";
                    } else if (errorCode === 'auth/wrong-password') {
                        errorElement.textContent = "Incorrect password";
                    } else {
                        errorElement.textContent = "Login failed: " + errorMessage;
                    }
                    
                    errorElement.style.display = "block";
                });
        });

        // Google login
        document.getElementById('googleLoginButton').addEventListener('click', () => {
            signInWithPopup(auth, provider)
                .then((result) => {
                    // Google login successful
                    const user = result.user;
                    localStorage.setItem('userLoggedIn', 'true');
                    localStorage.setItem('userEmail', user.email);
                    localStorage.setItem('userId', user.uid);
                    localStorage.setItem('isGuest', 'false');
                    window.location.href = 'index.html';
                })
                .catch((error) => {
                    // Handle errors
                    const errorCode = error.code;
                    const errorMessage = error.message;
                    console.error(errorCode, errorMessage);
                    
                    const errorElement = document.getElementById('loginError');
                    errorElement.textContent = "Google login failed: " + errorMessage;
                    errorElement.style.display = "block";
                });
        });

        // Guest login - no Firebase, just use localStorage
        document.getElementById('guestLoginButton').addEventListener('click', (e) => {
            e.preventDefault();
            
            // Set guest status in localStorage without using Firebase
            localStorage.setItem('userLoggedIn', 'true');
            localStorage.setItem('isGuest', 'true');
            localStorage.setItem('userEmail', 'guest');
            localStorage.setItem('userId', 'guest-' + Math.random().toString(36).substring(2, 15));
            window.location.href = 'index.html';
        });
      </script>

      <script src="storage/js/cloak.js"></script>
      <script src="storage/js/theme.js"></script>
      <script src="storage/js/cookie.js"></script>
  </body>
</html> 